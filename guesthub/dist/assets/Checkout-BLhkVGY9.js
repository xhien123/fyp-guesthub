import{g as Q,p as J,u as E,R as s,j as e,n as X,a as Z,q as ee,l as te}from"./index-CtBX9Jbf.js";import{i as se}from"./Inroomdining-DgRkofh3.js";import{b as ae}from"./Beach view 2-DYhOJ95A.js";const re="http://192.168.1.145:4000",le=a=>a?a.startsWith("http")?a:`${re}${a}`:"",ne="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200&q=80&auto=format&fit=crop",ie=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{d:"M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.408-1.41a7.002 7.002 0 00-13.074.003z"})}),oe=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5H10.75V5z",clipRule:"evenodd"})}),ce=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M11.7.066A8.25 8.25 0 0110 2C8.024 2 6.22 3.328 5.42 5.097A8.209 8.209 0 014.25 5C2.455 5 1 6.455 1 8.25v3.5C1 13.545 2.455 15 4.25 15c.144 0 .287-.01.428-.029A8.21 8.21 0 015.42 16.903C6.22 18.672 8.024 20 10 2c1.976 0 3.78-1.328 4.58-3.097A8.209 8.209 0 0115.75 17c1.795 0 3.25-1.455 3.25-3.25v-3.5C19 8.455 17.545 7 15.75 7c-.144 0-.287.01-.428.029A8.21 8.21 0 0114.58 5.097C13.78 3.328 11.976 2 10 2c-.392 0-.776.053-1.148.151A8.25 8.25 0 0111.7.066zM10 4.5a.75.75 0 01.75.75v.01a.75.75 0 01-1.5 0v-.01a.75.75 0 01.75-.75zM10 8a.75.75 0 01.75.75v.01a.75.75 0 01-1.5 0v-.01A.75.75 0 0110 8z",clipRule:"evenodd"})}),de=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.25a.75.75 0 001.5 0V2.75z"}),e.jsx("path",{fillRule:"evenodd",d:"M6.19 14.72a.75.75 0 011.06 0l3 3a.75.75 0 01-1.06 1.06L7.25 15.78a.75.75 0 010-1.06z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M12.75 15.78a.75.75 0 010 1.06l-3 3a.75.75 0 11-1.06-1.06l3-3a.75.75 0 011.06 0z",clipRule:"evenodd"})]}),ue=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.5H3.25a.75.75 0 000 1.5h.5c.347 0 .684.032 1.01.096l1.248 10.925A2.75 2.75 0 008.75 18h2.5a2.75 2.75 0 002.73-2.629l1.247-10.925a2.72 2.72 0 001.01-.096h.5a.75.75 0 000-1.5H14v-.5A2.75 2.75 0 0011.25 1h-2.5zM7.5 3.75c0-.69.56-1.25 1.25-1.25h2.5c.69 0 1.25.56 1.25 1.25v.5h-5v-.5z",clipRule:"evenodd"})}),me=({open:a,onClose:r,status:c})=>{const i=E(),[k,o]=s.useState(a),[u,h]=s.useState("enter");s.useEffect(()=>{if(a)o(!0),requestAnimationFrame(()=>h("enter"));else{h("leave");const g=setTimeout(()=>o(!1),300);return()=>clearTimeout(g)}},[a]);const[p,j,m,N]=s.useMemo(()=>c==="Pending"||c==="Confirmed"?["In-Residence Dining Is Not Yet Active",`In-room dining is exclusively available for 'Checked-in' guests. Your booking is currently '${c}'. This feature will be available upon your arrival at the resort.`,!1,!0]:["Book a Room to Order In-Room Dining","In-room dining is an exclusive service for our checked-in guests. Please book a stay or check-in to your residence to proceed.",!0,!1],[c]);if(!k)return null;const d=g=>{h("leave"),setTimeout(()=>{g?.(),r()},260)},C="fixed right-6 top-24 z-[10001] w-[450px] max-w-[90vw] overflow-hidden border border-neutral-200 bg-white shadow-2xl transition-all duration-300 "+(u==="enter"?"opacity-100 translate-y-0":"opacity-0 translate-y-3"),f="fixed inset-0 z-[10000] bg-black/40 backdrop-blur-sm "+(u==="enter"?"opacity-100":"opacity-0")+" transition-opacity duration-300";return e.jsxs(e.Fragment,{children:[e.jsx("button",{"aria-label":"Close popup",onClick:()=>d(),className:f}),e.jsxs("div",{className:C,children:[e.jsx("div",{className:"h-40 w-full bg-cover bg-center",style:{backgroundImage:`url(${ae})`}}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("img",{src:te,alt:"GuestHub logo",className:"h-10 w-10 object-cover"}),e.jsx("h3",{className:"text-2xl font-semibold text-teal-700",children:p})]}),e.jsx("p",{className:"text-[15px] leading-relaxed text-slate-700 mb-6",children:j}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>d(()=>i("/restaurants")),className:"w-full border border-slate-300 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50 transition",children:"← Back to Menu"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[N&&e.jsx("button",{onClick:()=>d(()=>i("/profile?sec=upcoming")),className:"bg-amber-700 py-2.5 text-center text-sm font-medium text-white hover:bg-amber-600 transition",children:"View My Booking"}),m&&e.jsx("button",{onClick:()=>d(()=>i("/contact")),className:"border border-teal-500 py-2.5 text-center text-sm font-medium text-teal-700 hover:bg-teal-50 transition",children:"Contact Us"})]})]})]})]})]})},xe=({value:a,onChange:r,onRemove:c,disabled:i})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:c,className:"w-8 h-8 flex items-center justify-center text-red-600 border border-red-300 hover:bg-red-50 transition-all active:scale-95 disabled:opacity-50","aria-label":"Remove item",children:e.jsx(ue,{})}),e.jsxs("div",{className:"inline-flex items-center",children:[e.jsx("button",{type:"button",disabled:i||a<=1,onClick:()=>r(Math.max(1,a-1)),className:"w-8 h-8 flex items-center justify-center border border-neutral-300 text-neutral-600 transition-transform active:scale-95 disabled:opacity-50 hover:bg-neutral-100","aria-label":"Decrease quantity",children:"–"}),e.jsx("div",{className:"min-w-[2.5rem] px-2 py-1 text-center font-semibold text-lg text-neutral-800 border-t border-b border-neutral-300",children:a}),e.jsx("button",{type:"button",disabled:i,onClick:()=>r(a+1),className:"w-8 h-8 flex items-center justify-center border border-neutral-300 text-neutral-600 transition-transform active:scale-95 disabled:opacity-50 hover:bg-neutral-100","aria-label":"Increase quantity",children:"+"})]})]}),fe=()=>{const{user:a}=Q(),{items:r,clearCart:c,updateItemQty:i,setItemNote:k}=J(),o=E(),[u,h]=s.useState(""),[p,j]=s.useState(""),[m,N]=s.useState("asap"),[d,C]=s.useState(""),[f,g]=s.useState(1),[I,q]=s.useState(!1),[$,G]=s.useState(""),[_,M]=s.useState(null),[y,P]=s.useState(!1),[z,v]=s.useState(null),[L,O]=s.useState(!1),[H,B]=s.useState(!0),[S,U]=s.useState(null),[T,V]=s.useState(null),R=s.useRef(!1);s.useEffect(()=>{(async()=>{if(!a){B(!1);return}try{const[l,x]=await Promise.all([X.get("/api/orders/me").catch(()=>({data:[]})),Z().catch(()=>null)]),b=l.data.find(n=>["Received","Preparing","Ready"].includes(n.status));if(b&&U(b),x&&(V(x),a.name&&h(a.name),x.room)){const n=typeof x.room=="object"?x.room.title:"";n&&j(n)}}catch(l){console.error("Error verifying checkout status:",l)}finally{B(!1)}})()},[a]);const w=r.reduce((t,l)=>t+l.price*l.quantity,0),A=w*.1,D=(w+A)*.08,Y=w+A+D;s.useEffect(()=>{R.current=!1},[]),s.useEffect(()=>{!r.length&&!y&&!R.current&&o("/restaurants")},[r.length,y,o]);const W=()=>{const t=new Date().getHours();return t<12?"Good Morning":t<18?"Good Afternoon":"Good Evening"},K=async t=>{if(t.preventDefault(),v(null),!T){O(!0);return}if(!u.trim()){v("Please enter the name for the order.");return}if(!p.trim()){v("Please confirm your Residence Number.");return}if(m==="later"&&!d){v("Please select a time for your scheduled delivery.");return}let l=m==="asap"?"Deliver As Soon As Possible.":`Deliver at scheduled time: ${d}.`;const x=[`Cutlery: ${f===0?"None":`${f} set(s)`}`,I?"Include extra sauces":null].filter(Boolean).join(". "),F=`---
Guest Name: ${u}
Delivery: ${l}
Preferences: ${x}
General Note: ${$||"N/A"}
---`;try{P(!0);const b=await ee({items:r.map(n=>({_id:n._id,name:n.name,price:n.price,quantity:n.quantity,notes:n.notes||void 0})),service:"room_delivery",payment:"charge_to_room",roomNumber:p.trim(),note:F});R.current=!0,c(),o(`/orders/${b._id}/status`)}catch(b){v(b?.response?.data?.error||"We encountered an issue placing your order.")}finally{P(!1)}};return H?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50 text-stone-500 font-serif animate-pulse",children:"Verifying residence status..."}):S?e.jsx("div",{className:"fixed inset-0 z-[20000] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-lg bg-white shadow-2xl animate-in fade-in zoom-in duration-300",children:[e.jsx("div",{className:"p-6 bg-stone-800 text-white",children:e.jsx("h2",{className:"text-xl font-serif font-bold",children:"Active Order Found"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("p",{className:"text-sm text-stone-700",children:["Our records indicate you already have a dining order in progress (Status: ",e.jsx("strong",{children:S.status}),")."]}),e.jsx("p",{className:"text-sm text-stone-600",children:"To ensure the highest quality of service and coordination, we permit one active dining order at a time per guest. Please wait for your meal to be delivered before placing a new request."})]}),e.jsxs("div",{className:"flex justify-end gap-4 p-4 bg-stone-50 border-t border-stone-200",children:[e.jsx("button",{type:"button",onClick:()=>o("/restaurants"),className:"px-6 py-2 font-semibold text-stone-700 border border-stone-300 bg-white hover:bg-stone-100 transition",children:"Return to Menu"}),e.jsx("button",{type:"button",onClick:()=>o(`/orders/${S._id}/status`),className:"px-6 py-2 font-semibold text-white transition bg-amber-700 hover:bg-amber-600",children:"Track Live Order"})]})]})}):r.length?e.jsxs("div",{className:"bg-neutral-50/50 min-h-screen",children:[e.jsxs("div",{className:"container max-w-7xl py-16",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h1",{className:"text-6xl font-serif font-light tracking-tight text-neutral-800 mb-3",children:[W(),", ",u.split(" ")[0]||"Esteemed Guest"]}),e.jsx("p",{className:"text-neutral-500 text-xl font-light",children:"Please confirm your details to finalize your in-residence order."})]}),e.jsxs("form",{onSubmit:K,className:"grid grid-cols-1 lg:grid-cols-3 lg:gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-10",children:[e.jsxs("section",{className:"bg-white p-8 border border-neutral-200 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-800 border-b pb-4 mb-6",children:"Guest & Residence Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"guestName",className:"block text-sm font-medium text-neutral-600 mb-1",children:"Guest Name (Required)"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none",children:e.jsx(ie,{})}),e.jsx("input",{id:"guestName",value:u,onChange:t=>h(t.target.value),placeholder:"Enter your full name",className:"w-full border border-neutral-300 focus:border-teal-600 focus:ring-1 focus:ring-teal-600 px-4 py-3 pl-11 text-lg transition duration-200"}),!a&&e.jsx("p",{className:"text-xs text-neutral-500 mt-2",children:"Please ensure the name matches your active reservation."})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"roomNumber",className:"block text-sm font-medium text-neutral-600 mb-1",children:"Residence Number (Required)"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none",children:e.jsx(ce,{})}),e.jsx("input",{id:"roomNumber",value:p,onChange:t=>j(t.target.value),placeholder:"e.g., 501",className:"w-full border border-neutral-300 focus:border-teal-600 focus:ring-1 focus:ring-teal-600 px-4 py-3 pl-11 text-lg transition duration-200"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-800 mb-6",children:"Order Summary & Adjustments"}),e.jsx("div",{className:"space-y-5 bg-white border border-neutral-200 shadow-lg overflow-hidden",children:r.map(t=>e.jsxs("div",{className:"flex items-start gap-4 p-6 border-b border-neutral-100 last:border-b-0",children:[e.jsx("img",{src:le(t.photo)||ne,alt:t.name,className:"w-20 h-20 object-cover shadow-sm flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-neutral-800 text-lg",children:t.name}),e.jsxs("p",{className:"text-sm text-neutral-500 mb-3",children:["Unit Price: $",t.price.toFixed(2)]}),_===t._id?e.jsx("textarea",{placeholder:"e.g., no onion, extra spicy",value:t.notes||"",onChange:l=>k(t._id,l.target.value),onBlur:()=>M(null),autoFocus:!0,className:"w-full text-sm border border-neutral-300 p-2 resize-none",rows:2}):e.jsx("button",{type:"button",onClick:()=>M(t._id),className:"text-sm text-teal-700 hover:text-teal-600 font-medium",children:t.notes?`Edit note: "${t.notes}"`:"+ Add special instructions"})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("span",{className:"text-lg font-semibold text-neutral-700",children:["$",(t.price*t.quantity).toFixed(2)]}),e.jsx(xe,{value:t.quantity,onChange:l=>i(t._id,l),onRemove:()=>i(t._id,0)})]})]},t._id))})]}),e.jsxs("section",{className:"bg-white p-8 border border-neutral-200 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-800 mb-6",children:"Delivery Time"}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"When would you like your order?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>N("asap"),className:`px-4 py-3 border text-center transition ${m==="asap"?"bg-teal-600 text-white border-teal-600 shadow-md":"bg-white text-neutral-700 border-neutral-300 hover:bg-neutral-50"}`,children:["As Soon As Possible",e.jsx("span",{className:"block text-xs opacity-80",children:"(Est. 30-45 min)"})]}),e.jsx("button",{type:"button",onClick:()=>N("later"),className:`px-4 py-3 border text-center transition ${m==="later"?"bg-teal-600 text-white border-teal-600 shadow-md":"bg-white text-neutral-700 border-neutral-300 hover:bg-neutral-50"}`,children:"Schedule for Later"})]}),m==="later"&&e.jsxs("div",{className:"relative mt-3",children:[e.jsx("label",{htmlFor:"scheduledTime",className:"sr-only",children:"Scheduled Time"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none",children:e.jsx(oe,{})}),e.jsx("input",{id:"scheduledTime",type:"time",value:d,onChange:t=>C(t.target.value),className:"w-full border border-neutral-300 focus:border-teal-600 focus:ring-1 focus:ring-teal-600 px-4 py-3 pl-11 text-lg transition duration-200"})]})]})})]}),e.jsxs("section",{className:"bg-white p-8 border border-neutral-200 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-800 mb-6",children:"Service Preferences"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"Cutlery Sets"}),e.jsx("div",{className:"flex items-center gap-2",children:[0,1,2,3,4].map(t=>e.jsxs("button",{type:"button",onClick:()=>g(t),className:`w-14 h-14 border transition ${f===t?"bg-teal-600 text-white border-teal-600 shadow-md":"bg-white text-neutral-700 border-neutral-300 hover:bg-neutral-50"}`,children:[e.jsx("span",{className:"font-semibold text-lg",children:t}),e.jsx("span",{className:"block text-xs opacity-80",children:t===0?"None":"Set(s)"})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-600 mb-2",children:"Dining Extras"}),e.jsxs("div",{className:"relative flex items-start",children:[e.jsx("div",{className:"flex h-6 items-center",children:e.jsx("input",{id:"addSauces",name:"addSauces",type:"checkbox",checked:I,onChange:t=>q(t.target.checked),className:"h-4 w-4 border-neutral-300 text-teal-600 focus:ring-teal-600"})}),e.jsxs("div",{className:"ml-3 text-sm leading-6",children:[e.jsx("label",{htmlFor:"addSauces",className:"font-medium text-neutral-700",children:"Include Condiments (Default Set)"}),e.jsx("p",{className:"text-neutral-500",children:"(Ketchup, Mayonnaise, Chili Sauce)"})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"note",className:"block text-sm font-medium text-neutral-600 mb-1",children:"General Requests (Optional)"}),e.jsx("div",{className:"absolute top-10 left-0 flex items-center pl-3.5 pointer-events-none",children:e.jsx(de,{})}),e.jsx("textarea",{id:"note",value:$,onChange:t=>G(t.target.value),placeholder:"e.g., 'Please knock gently.'",rows:3,className:"w-full border border-neutral-300 focus:border-teal-600 focus:ring-1 focus:ring-teal-600 px-4 py-3 pl-11 transition duration-200 resize-none"})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1 mt-10 lg:mt-0",children:e.jsxs("div",{className:"sticky top-24 space-y-6",children:[e.jsxs("div",{className:"overflow-hidden shadow-2xl relative h-48",children:[e.jsx("img",{src:se,alt:"Luxury In-Room Dining Experience",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/30 flex flex-col justify-end p-5",children:e.jsx("h3",{className:"text-xl font-light text-white leading-snug",children:"Your Personal Butler Awaits"})})]}),e.jsxs("div",{className:"bg-white p-8 border border-neutral-200 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-neutral-800 border-b pb-4 mb-4",children:"Order Total"}),e.jsxs("div",{className:"space-y-3 text-neutral-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",w.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Service Fee (10%)"}),e.jsxs("span",{children:["$",A.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax (8%)"}),e.jsxs("span",{children:["$",D.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-2xl pt-4 mt-4 border-t border-neutral-300 text-neutral-900",children:[e.jsx("span",{children:"Grand Total"}),e.jsxs("span",{children:["$",Y.toFixed(2)]})]}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-teal-50 p-4 border border-teal-200",children:[e.jsx("span",{className:"text-teal-700 text-2xl",children:"★"}),e.jsx("span",{className:"font-semibold text-teal-800",children:"Charge to Residence Account"})]}),z&&e.jsx("p",{className:"text-red-600 text-sm font-medium pt-2",children:z}),e.jsx("button",{type:"submit",disabled:y||r.length===0,className:"w-full bg-[#112f4c] text-white py-4 font-bold tracking-widest uppercase text-lg transition duration-300 hover:bg-[#0b1a2c] disabled:bg-neutral-300 disabled:cursor-not-allowed",children:y?"Dispatching Order…":"Confirm & Charge to Residence"}),e.jsx("p",{className:"text-xs text-center text-neutral-500 pt-1",children:"By confirming, you authorize the charge to your active residence account."})]})]})]})})]})]}),e.jsx(me,{open:L,onClose:()=>O(!1),status:T?.status||null})]}):e.jsxs("div",{className:"container max-w-4xl py-20",children:[e.jsx("h1",{className:"text-4xl font-light tracking-tight text-neutral-800 mb-6",children:"Your In-Residence Order"}),e.jsxs("div",{className:"border border-dashed border-neutral-300 bg-white/70 p-10 text-center space-y-4",children:[e.jsx("p",{className:"text-lg text-neutral-700",children:"You don't have any items in your order yet."}),e.jsx("button",{onClick:()=>o("/restaurants"),className:"inline-flex items-center justify-center bg-[#112f4c] px-6 py-3 text-sm font-semibold tracking-wide text-white hover:bg-[#0b1a2c] transition",children:"Browse Menu"})]})]})};export{fe as default};
