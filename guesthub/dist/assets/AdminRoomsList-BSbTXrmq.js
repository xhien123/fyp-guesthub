import{w as E,H as F,d as G,R as l,I as H,j as e,L as D,J as V,K as W}from"./index-DGXRDi1R.js";import{T as K,P as J}from"./Skeleton-PYZoJDwR.js";const q=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),Q=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),X=()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6h1v10H3v-1h16v1h-1V6h1a2 2 0 01-2 2v4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})}),Y=()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),se=()=>{const{toast:x}=E(),$=F(),[n,N]=G(),[B,h]=l.useState([]),[_,w]=l.useState(!0),[y,k]=l.useState(null),p=n.get("type")||"",u=n.get("avail")||"",g=n.get("min")||"",f=n.get("max")||"",S=n.get("sort")||"title:asc",C=Number(n.get("page")||"1"),v=Number(n.get("pageSize")||"10"),[c,m]=l.useMemo(()=>{const[t,s]=S.split(":");return[["title","type","pricePerNight","maxOccupancy","beds","available"].includes(t)?t:"title",s==="desc"?"desc":"asc"]},[S]),o=(t,s)=>{const a=new URLSearchParams(n);s&&s.length?a.set(t,s):a.delete(t),["type","avail","min","max"].includes(t)&&a.set("page","1"),N(a,{replace:!0})},z=t=>{o("sort",`${t}:${c===t&&m==="asc"?"desc":"asc"}`)},I=t=>o("page",String(Math.max(1,t))),O=t=>{const s=new URLSearchParams(n);s.set("pageSize",String(t)),s.set("page","1"),N(s,{replace:!0})},j=l.useCallback(async()=>{try{w(!0),k(null);const t=await H();h(Array.isArray(t)?t:[])}catch(t){k(t?.response?.data?.error||"Failed to load rooms")}finally{w(!1)}},[]);l.useEffect(()=>{j()},[j]);const T=async t=>{if(await $({title:"Delete Residence?",message:"This will permanently remove the room from inventory.",confirmText:"Delete Forever"}))try{await W(t),x({title:"Residence removed",variant:"success"}),await j()}catch{x({title:"Failed to delete",variant:"error"})}},U=async t=>{const s=t.available,a=!s;h(r=>r.map(i=>i._id===t._id?{...i,available:a}:i));try{await V(t._id,{available:a}),x({title:a?"Residence Opened":"Residence Stopped",description:`Availability updated for ${t.title}`,variant:"success"})}catch{h(i=>i.map(b=>b._id===t._id?{...b,available:s}:b)),x({title:"Update Failed",description:"Could not update room status.",variant:"error"})}},A=[...B.filter(t=>{if(p&&t.type!==p)return!1;if(u){const a=u==="true";if((t.available??!0)!==a)return!1}const s=Number(t.pricePerNight??0);return!(g&&s<Number(g)||f&&s>Number(f))})].sort((t,s)=>{let a=0;const r=Number(t.maxOccupancy||t.maxGuests||0),i=Number(s.maxOccupancy||s.maxGuests||0);switch(c){case"title":a=String(t.title).localeCompare(String(s.title));break;case"type":a=String(t.type).localeCompare(String(s.type));break;case"pricePerNight":a=Number(t.pricePerNight??0)-Number(s.pricePerNight??0);break;case"maxOccupancy":a=r-i;break;case"beds":a=Number(t.beds??0)-Number(s.beds??0);break;case"available":a=+!!t.available-+!!s.available;break;default:a=0}return m==="asc"?a:-a}),P=(C-1)*v,L=A.slice(P,P+v),d=({k:t,children:s})=>e.jsxs("button",{onClick:()=>z(t),className:"inline-flex items-center gap-1 hover:text-stone-900 text-[10px] font-bold uppercase tracking-widest text-stone-500 transition-colors group",children:[s,e.jsx("span",{className:`text-[10px] ${c===t?"text-stone-800":"text-stone-300 group-hover:text-stone-400"}`,children:c===t?m==="asc"?"▲":"▼":"▵▿"})]}),R="bg-stone-50 border border-stone-200 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-stone-400 outline-none min-w-[140px]",M="bg-stone-50 border border-stone-200 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-stone-400 outline-none w-24";return _?e.jsx(K,{rows:8,cols:6}):y?e.jsx("div",{className:"p-12 text-center text-red-600",children:y}):e.jsxs("div",{className:"max-w-[1400px] mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-end mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-serif text-stone-800 mb-2",children:"Inventory Dashboard"}),e.jsx("p",{className:"text-stone-500 font-light",children:"Manage resort accommodations, pricing, and status."})]}),e.jsxs("div",{className:"text-right flex flex-col items-end gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-stone-400",children:"Sorting By"}),e.jsxs("div",{className:"text-sm font-bold text-stone-800",children:[c.toUpperCase()," (",m==="asc"?"Asc":"Desc",")"]})]}),e.jsx(D,{to:"/admin/rooms/new",className:"bg-stone-900 hover:bg-black text-white px-6 py-2.5 text-sm font-medium uppercase tracking-wider rounded-md shadow-lg shadow-stone-200 transition-all hover:-translate-y-0.5",children:"+ New Residence"})]})]}),e.jsxs("div",{className:"mb-8 p-5 border border-stone-200 bg-white shadow-sm rounded-lg flex flex-wrap items-end gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-2",children:"Category"}),e.jsxs("select",{className:R,value:p,onChange:t=>o("type",t.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{children:"Standard"}),e.jsx("option",{children:"Deluxe"}),e.jsx("option",{children:"Suite"}),e.jsx("option",{children:"Family"}),e.jsx("option",{children:"Villa"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-2",children:"Status"}),e.jsxs("select",{className:R,value:u,onChange:t=>o("avail",t.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Stopped"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-2",children:"Price Range"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",className:M,value:g,onChange:t=>o("min",t.target.value),placeholder:"Min $"}),e.jsx("span",{className:"text-stone-300",children:"-"}),e.jsx("input",{type:"number",className:M,value:f,onChange:t=>o("max",t.target.value),placeholder:"Max $"})]})]})]}),e.jsx("div",{className:"bg-white border border-stone-200 rounded-lg shadow-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-stone-50 border-b border-stone-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-medium text-stone-500 w-[30%]",children:e.jsx(d,{k:"title",children:"Residence"})}),e.jsx("th",{className:"p-4 font-medium text-stone-500",children:e.jsx(d,{k:"type",children:"Category"})}),e.jsx("th",{className:"p-4 font-medium text-stone-500",children:e.jsx(d,{k:"pricePerNight",children:"Rate"})}),e.jsx("th",{className:"p-4 font-medium text-stone-500",children:e.jsx(d,{k:"maxOccupancy",children:"Capacity"})}),e.jsx("th",{className:"p-4 font-medium text-stone-500",children:e.jsx(d,{k:"available",children:"Status"})}),e.jsx("th",{className:"p-4 font-medium text-stone-500 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-stone-100",children:[L.map(t=>{const s=t.available??!0,a=t.photos&&t.photos[0]?t.photos[0]:null;return e.jsxs("tr",{className:"hover:bg-stone-50 transition-colors group",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-stone-100 rounded-md overflow-hidden flex-shrink-0 border border-stone-200",children:a?e.jsx("img",{src:a,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-stone-300 text-[9px]",children:"NO IMG"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-serif font-medium text-lg text-stone-900",children:t.title}),e.jsxs("div",{className:"text-xs font-mono text-stone-400 bg-stone-50 inline-block px-1 rounded border border-stone-100",children:["ID: ",t._id.slice(-6)]})]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-sm text-stone-600 font-medium",children:t.type})}),e.jsxs("td",{className:"p-4 font-serif text-base text-stone-800",children:["$",Number(t.pricePerNight??0).toLocaleString()]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-stone-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{}),e.jsxs("span",{children:[t.maxOccupancy||t.maxGuests," Guests"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{}),e.jsxs("span",{children:[t.beds," Beds"]})]})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>U(t),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-stone-200 ${s?"bg-emerald-500":"bg-stone-300"}`,title:s?"Click to Stop":"Click to Activate",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-md transition-transform duration-300 ${s?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:`text-[10px] uppercase tracking-widest font-bold ${s?"text-emerald-600":"text-stone-400"}`,children:s?"Active":"Stopped"})]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-3 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx(D,{to:`/admin/rooms/${t._id}/edit`,className:"text-stone-400 hover:text-stone-900 transition-colors p-2 hover:bg-stone-100 rounded-full",title:"Edit Details",children:e.jsx(q,{})}),e.jsx("button",{onClick:()=>T(t._id),className:"text-stone-300 hover:text-rose-600 transition-colors p-2 hover:bg-rose-50 rounded-full",title:"Delete Room",children:e.jsx(Q,{})})]})})]},t._id)}),L.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-12 text-center text-stone-400 italic font-serif",colSpan:6,children:"No inventory found matching your filters."})})]})]})}),e.jsx(J,{className:"mt-6",page:C,pageSize:v,total:A.length,onPage:I,onPageSize:O})]})};export{se as default};
