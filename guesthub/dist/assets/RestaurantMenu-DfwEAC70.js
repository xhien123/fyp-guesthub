import{j as e,d as Y,R as p,S as Z,X,q as J,w as B}from"./index-DGXRDi1R.js";const V=({categories:t,active:s="all",onChange:n})=>{const l=[{_id:"all",name:"All"},...t];return e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(c=>{const u=c._id??c.name,r=s===u;return e.jsx("button",{onClick:()=>n(String(u)),className:`px-3 py-1.5 rounded-full text-sm border transition ${r?"bg-black text-white border-black":"bg-white border-neutral-300 hover:bg-neutral-50"}`,children:c.name},u)})})},T="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200&q=80&auto=format&fit=crop",Q="http://localhost:4000",$=t=>t?t.startsWith("http")?t:`${Q}${t}`:"",K=t=>{const[s,n]=(t||"price:asc").split(":");return[s==="name"?"name":"price",n==="desc"?"desc":"asc"]},ee={"savory-sizzle":"lunch_dinner","vive-oceane":"food_dining"},te=(t,s)=>s&&s.length>0?s:t==="savory-sizzle"?[{key:"breakfast",label:"Breakfast"},{key:"lunch_dinner",label:"Dining & Drinks"}]:[{key:"food_dining",label:"All Day Dining"}],se=["starter","entree","entrée","appetizer","small plates","main","mains","secondi","dessert","desserts"],ae=["soft drink","soft drinks","mocktail","mocktails","cocktail","cocktails","spirits","beer","wine","wines","beverages & wines"],A=t=>{const s=(t||"").toLowerCase(),n=u=>{const r=u.findIndex(d=>s===d||s.includes(d));return r===-1?null:r},l=n(se);if(l!==null)return l;const c=n(ae);return c!==null?100+c:1e3},ne=({value:t,max:s=99,onChange:n,disabled:l})=>e.jsxs("div",{className:"inline-flex items-center border border-stone-300 bg-white h-8",children:[e.jsx("button",{type:"button",disabled:l||t<=0,onClick:()=>n(Math.max(0,t-1)),className:"px-3 h-full transition-colors hover:bg-stone-100 disabled:opacity-50 text-stone-600","aria-label":"Decrease",children:"–"}),e.jsx("div",{className:"w-8 h-full flex items-center justify-center text-sm font-serif text-stone-900 border-x border-stone-100",children:t}),e.jsx("button",{type:"button",disabled:l||t>=s,onClick:()=>n(t+1),className:"px-3 h-full transition-colors hover:bg-stone-100 disabled:opacity-50 text-stone-600","aria-label":"Increase",children:"+"})]}),re=({item:t,currentQty:s,addOrSetQty:n})=>{const{toast:l}=B(),[c,u]=p.useState($(t.photo)||$(t.imagePath)||T),r=!(typeof t.available=="boolean"?t.available:t.isAvailable),d=t.quantity===null||t.quantity===void 0?999:t.quantity,f=d<5&&d>0&&d!==999,x=o=>{if(r)return;if(o>d){l({title:"Limited Availability",description:`We apologize, but we currently have only ${d} portions remaining of this dish.`,variant:"warning"});return}const i=Math.max(0,o);n(t,i,s)};return e.jsxs("div",{className:"group flex flex-col bg-white border border-stone-200 shadow-sm hover:shadow-xl transition-all duration-500",children:[e.jsxs("div",{className:"relative aspect-[4/3] w-full overflow-hidden bg-stone-100",children:[e.jsx("img",{src:c,alt:t.name,loading:"lazy",onError:()=>u(T),className:`h-full w-full object-cover transition-transform duration-700 group-hover:scale-105 ${r?"grayscale opacity-60":""}`}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 backdrop-blur-[2px] border-stone-200 m-2 border",children:e.jsx("span",{className:"font-serif text-lg uppercase tracking-widest text-stone-900 border-b-2 border-stone-900 pb-1",children:"Sold Out"})}),!r&&f&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-stone-900 text-white py-1 px-3",children:e.jsxs("p",{className:"text-[10px] uppercase tracking-widest font-medium text-center",children:["Limited: Only ",d," Remaining"]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col p-5 gap-3",children:[e.jsxs("div",{className:"flex justify-between items-baseline gap-4",children:[e.jsx("h3",{className:"font-serif text-lg text-stone-900 leading-tight group-hover:text-stone-600 transition-colors",children:t.name}),e.jsxs("span",{className:"shrink-0 font-sans text-sm font-medium text-stone-900",children:["$",Number(t.price??0).toFixed(2)]})]}),t.description&&e.jsx("p",{className:"text-xs text-stone-500 leading-relaxed line-clamp-2 font-light",children:t.description}),e.jsxs("div",{className:"mt-auto pt-4 flex items-center justify-between border-t border-stone-100",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-stone-400 font-medium",children:s>0?"In Your Order":"Quantity"}),e.jsx(ne,{value:s,max:d,onChange:x,disabled:r})]})]})]})},oe=({items:t})=>{const s=J(),{items:n=[],totalQty:l=0}=s,c=s.addItem,u=s.updateItemQty,r=s.removeItem,{toast:d}=B(),f=p.useCallback(o=>n.find(i=>i._id===o)?.quantity??0,[n]),x=p.useCallback((o,i,y)=>{const N=l-y;if(i+N>10){d({title:"Order Limit",description:"For optimal service, we limit orders to 10 items.",variant:"warning"});return}if(y===0){if(i<=0)return;c&&c(o,i)}else if(u)u(o._id,i);else if(c&&r)if(i===0)r(o._id);else{const b=i-y;b>0?c(o,b):r(o._id,-b)}d({title:i===0?"Item Removed":"Order Updated",description:i===0?o.name:`${o.name} × ${i}`,variant:"success"});try{window.dispatchEvent(new CustomEvent("cart:bump"))}catch{}},[l,d,u,c,r]);return e.jsx("div",{className:"grid gap-8 sm:grid-cols-2 lg:grid-cols-3",children:t.map(o=>e.jsx(re,{item:o,currentQty:f(o._id),addOrSetQty:x},o._id))})},le=({restaurantKey:t,mealTabs:s})=>{const[n,l]=Y(),c=te(t,s),u=ee[t],r=n.get("type")||u,d=a=>{const m=new URLSearchParams(n);m.set("type",a),m.delete("cat"),m.delete("q"),l(m,{replace:!0})},f=n.get("cat")||"all",x=n.get("q")||"",[o,i]=K(n.get("sort")),[y,N]=p.useState([]),[b,M]=p.useState([]),[w,_]=p.useState(x),[I,E]=p.useState(!0),[k,L]=p.useState(null),j=p.useCallback((a,m)=>{const h=new URLSearchParams(n);m&&m.length?h.set(a,m):h.delete(a),l(h,{replace:!0})},[n,l]),F=a=>j("cat",a),U=a=>j("sort",a);p.useEffect(()=>{const a=window.setTimeout(()=>{(x||"")!==(w||"")&&j("q",w.trim()?w.trim():void 0)},300);return()=>window.clearTimeout(a)},[w,x,j]),p.useEffect(()=>{(async()=>{try{const m={restaurant:t,...r==="breakfast"?{mealType:"breakfast"}:{}},h=await Z(m).catch(()=>[]),R=[...Array.isArray(h)?h:h?.categories||[]].sort((g,v)=>{const C=A(g?.name),S=A(v?.name);return C!==S?C-S:String(g?.name||"").localeCompare(String(v?.name||""))});N(R)}catch{N([])}})()},[t,r]);const q=p.useCallback(async()=>{E(!0),L(null);try{const m={limit:100,restaurant:t,...r==="breakfast"?{mealType:"breakfast"}:{}};f!=="all"&&(m.category=f),x.trim()&&(m.search=x.trim());const h=await X(m),R=[...Array.isArray(h)?h:h?.items||[]].sort((g,v)=>{const C=typeof g.category=="object"?g.category?.name:"",S=typeof v.category=="object"?v.category?.name:"",z=A(C),D=A(S);if(z!==D)return z-D;if(o==="price"){const P=Number(g.price??0)-Number(v.price??0);return i==="asc"?P:-P}const O=String(g.name??"").localeCompare(String(v.name??""));return i==="asc"?O:-O});M(R)}catch(a){L(a?.response?.data?.error||"Failed to load menu")}finally{E(!1)}},[t,r,f,x,o,i]);p.useEffect(()=>{q()},[q]);const W=t==="savory-sizzle"?"The World's Table":"Oceanic Delights",G=t==="savory-sizzle"?"Refined European Classics":"Fresh Local Seafood & Grill";return e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12 space-y-10 bg-stone-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between border-b border-stone-200 pb-6 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-serif font-light text-stone-900 tracking-tight",children:W}),e.jsx("p",{className:"text-stone-500 text-sm tracking-wide uppercase font-medium",children:G})]}),e.jsx("div",{className:"flex border border-stone-300 bg-white",children:c.map(a=>{const m=a.key===r;return e.jsx("button",{onClick:()=>d(a.key),className:`px-6 py-3 text-xs font-bold uppercase tracking-widest transition-all ${m?"bg-stone-900 text-white":"bg-white text-stone-500 hover:bg-stone-50 hover:text-stone-900"}`,children:a.label},a.key)})})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"p-6 bg-white border border-stone-200 shadow-sm flex flex-col lg:flex-row gap-6 items-start lg:items-center",children:[e.jsx("div",{className:"flex-1 w-full lg:w-auto",children:e.jsx(V,{categories:y,active:f,onChange:F})}),e.jsx("div",{className:"h-px w-full lg:w-px lg:h-10 bg-stone-200"}),e.jsxs("div",{className:"flex flex-wrap gap-4 w-full lg:w-auto",children:[e.jsx("div",{className:"relative flex-1 min-w-[200px]",children:e.jsx("input",{value:w,onChange:a=>_(a.target.value),placeholder:"Search menu...",className:"w-full bg-stone-50 border-b border-stone-300 px-0 py-2 text-sm text-stone-900 placeholder-stone-400 focus:border-stone-900 focus:outline-none transition-colors rounded-none"})}),e.jsxs("select",{className:"bg-stone-50 border-b border-stone-300 py-2 pl-2 pr-8 text-sm text-stone-900 focus:border-stone-900 focus:outline-none cursor-pointer rounded-none min-w-[140px]",value:`${o}:${i}`,onChange:a=>U(a.target.value),children:[e.jsx("option",{value:"price:asc",children:"Price: Low to High"}),e.jsx("option",{value:"price:desc",children:"Price: High to Low"}),e.jsx("option",{value:"name:asc",children:"Name: A — Z"}),e.jsx("option",{value:"name:desc",children:"Name: Z — A"})]}),x&&e.jsx("button",{onClick:()=>{_(""),j("q",void 0)},className:"text-xs uppercase tracking-widest text-stone-400 hover:text-stone-900 border-b border-transparent hover:border-stone-900 transition-all",children:"Clear"})]})]})}),I&&e.jsx("div",{className:"py-20 text-center",children:e.jsx("p",{className:"font-serif text-xl text-stone-400 italic",children:"Curating your experience..."})}),k&&e.jsx("div",{className:"p-6 bg-red-50 border border-red-100 text-red-800 text-center font-medium",children:k}),!I&&!k&&b.length>0&&e.jsx(oe,{items:b}),!I&&!k&&b.length===0&&e.jsx("div",{className:"py-20 text-center border border-dashed border-stone-300",children:e.jsx("p",{className:"text-stone-500 font-serif text-lg italic",children:"No culinary items found matching your selection."})})]})};export{le as R};
