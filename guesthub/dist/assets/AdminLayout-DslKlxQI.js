import{g as A,B as M,r as o,A as S,j as e,L as p,O as z}from"./index-CtBX9Jbf.js";const E="http://192.168.1.145:4000",O=({show:r,title:d,message:a,type:h,onClose:i})=>{if(!r)return null;const x={booking:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}),order:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}),inquiry:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}),message:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})};return e.jsx("div",{className:"fixed bottom-8 right-8 z-[100] animate-in slide-in-from-bottom-10 duration-500",children:e.jsxs("div",{className:"bg-[#1c1917] text-white px-6 py-5 rounded-sm shadow-2xl border-l-4 border-[#d4af37] flex items-center gap-5 min-w-[350px] max-w-[450px]",children:[e.jsx("div",{className:"bg-[#d4af37] rounded-full p-2 flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x[h]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-xs font-bold text-[#d4af37] uppercase tracking-widest mb-1",children:d}),e.jsx("p",{className:"text-sm font-medium text-white/90 truncate",children:a})]}),e.jsx("button",{onClick:i,className:"text-white/40 hover:text-white transition-colors p-1",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})})},W=()=>{const{user:r,logout:d}=A(),a=M(),[h,i]=o.useState(0),[x,b]=o.useState(!1),[v,g]=o.useState(!1),[y,w]=o.useState(!1),[c,u]=o.useState({show:!1,title:"",msg:"",type:"booking"}),[,k]=o.useState(null),[s,j]=o.useState(!0),m=(t,n,l)=>{u({show:!0,title:t,msg:n,type:l}),setTimeout(()=>u(f=>({...f,show:!1})),6e3)};o.useEffect(()=>{fetch("/api/admin/chat/unread-count",{credentials:"include"}).then(n=>n.json()).then(n=>i(n.count||0)).catch(()=>i(0));const t=S(E,{transports:["websocket"],withCredentials:!0});return k(t),t.emit("admin:join:notifications"),t.on("chat:new-message",n=>{i(n.unreadCount),a.pathname.includes("/admin/chat")||m("Concierge Message","New guest message received.","message")}),t.on("booking:updated",n=>{if(n.status==="Pending"){b(!0);const l=n.guestName||"Guest",f=typeof n.room=="string"?"Room":n.room?.title||"Room";m("New Reservation Verified",`${l} confirmed for ${f}. Review needed.`,"booking")}}),t.on("order:new",n=>{g(!0);const l=n.roomNumber?`Room ${n.roomNumber}`:"Dine-in";m("New Order Received",`New request from ${l}.`,"order")}),t.on("inquiry:new",n=>{w(!0),m("New Inquiry",`${n.subject} from ${n.name}`,"inquiry")}),()=>{t.disconnect()}},[a.pathname]),o.useEffect(()=>{a.pathname==="/admin/bookings"&&b(!1),a.pathname==="/admin/orders"&&g(!1),a.pathname==="/admin/inquiries"&&w(!1)},[a.pathname]);const N=[{to:"/admin",icon:"fa-tachometer-alt",label:"Dashboard"},{to:"/admin/bookings",icon:"fa-door-closed",label:"Bookings",alert:x},{to:"/admin/orders",icon:"fa-utensils",label:"Orders",alert:v},{to:"/admin/inquiries",icon:"fa-envelope",label:"Inquiries",alert:y},{to:"/admin/rooms",icon:"fa-bed",label:"Rooms"},{to:"/admin/menu",icon:"fa-list-alt",label:"Menu"},{to:"/admin/chat",icon:"fa-comments",label:"Chat",count:h}],C=s?"w-64":"w-20",L=s?"ml-64":"ml-20",$=s?"fa-angle-double-left":"fa-angle-double-right";return e.jsxs("div",{className:"flex h-screen w-screen bg-neutral-100 overflow-hidden m-0 p-0",children:[e.jsx(O,{show:c.show,title:c.title,message:c.msg,type:c.type,onClose:()=>u(t=>({...t,show:!1}))}),e.jsxs("div",{className:`fixed z-50 h-full transition-all duration-300 ${C}`,children:[e.jsxs("div",{className:"bg-zinc-900 text-white flex flex-col flex-shrink-0 shadow-lg h-full",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx(p,{to:"/admin",className:`text-2xl font-serif font-bold text-yellow-400 overflow-hidden ${s?"block":"hidden"}`,children:"GuestHub Admin"}),!s&&e.jsx(p,{to:"/admin",className:"text-xl font-serif font-bold text-yellow-400 text-center",children:e.jsx("i",{className:"fas fa-bars text-lg"})})]}),e.jsxs("nav",{className:"flex-1 p-2 space-y-2 overflow-y-auto",children:[N.map(t=>e.jsxs(p,{to:t.to,className:`flex items-center p-3 rounded-lg transition-colors relative ${a.pathname.startsWith(t.to)&&t.to!=="/admin"||a.pathname==="/admin"&&t.to==="/admin"?"bg-yellow-500 text-zinc-900 font-semibold":"text-gray-300 hover:bg-zinc-800"}`,children:[e.jsx("i",{className:`fas ${t.icon} w-5 ${s?"mr-3":"mx-auto"}`}),e.jsx("span",{className:`transition-opacity duration-200 ${s?"opacity-100":"opacity-0 hidden"}`,children:t.label}),t.count&&t.count>0&&e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:t.count>9?"9+":t.count}),t.alert&&e.jsx("span",{className:"absolute right-2 top-2 h-3 w-3 bg-red-500 rounded-full border-2 border-zinc-900 animate-pulse"})]},t.to)),e.jsx("div",{className:"h-10"}),e.jsx("div",{className:"pt-2 border-t border-gray-700",children:e.jsxs("button",{onClick:()=>j(!s),className:"w-full flex items-center justify-start p-3 text-sm font-semibold text-gray-400 hover:text-yellow-400 transition","aria-label":s?"Collapse menu":"Expand menu",children:[e.jsx("i",{className:`fas ${$} w-5 ${s?"mr-3":"mx-auto"}`}),e.jsx("span",{className:s?"inline":"sr-only",children:s?"Collapse Menu":"Expand Menu"})]})})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700",children:[e.jsxs("p",{className:`text-sm font-medium text-gray-400 overflow-hidden ${s?"block":"hidden"}`,children:["Logged in as: ",r?.name||"Admin"]}),e.jsxs("button",{onClick:d,className:`mt-2 w-full text-left text-sm text-gray-400 hover:text-red-400 transition ${s?"text-left":"text-center"}`,children:[e.jsx("i",{className:`fas fa-sign-out-alt ${s?"mr-2":""}`}),e.jsx("span",{className:s?"inline":"sr-only",children:"Sign Out"})]})]})]}),e.jsx("button",{onClick:()=>j(!s),className:`absolute top-1/2 -translate-y-1/2 z-50 bg-zinc-900 border-2 border-yellow-500 text-yellow-500 shadow-xl p-2 transition-all duration-300 transform 
            right-[-12px] 
            hover:scale-110 focus:outline-none focus:ring-4 focus:ring-yellow-500/50 hidden lg:block`,style:{clipPath:s?"polygon(50% 0, 100% 50%, 50% 100%, 0% 50%)":"polygon(0 0, 100% 50%, 0 100%)"},"aria-label":s?"Collapse sidebar":"Expand sidebar",children:e.jsx("i",{className:`fas ${s?"fa-chevron-left":"fa-chevron-right"} text-sm`})})]}),e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${L}`,children:[e.jsxs("header",{className:"bg-zinc-900 text-white shadow-xl h-20 flex items-center justify-between px-8 flex-shrink-0",children:[e.jsxs("div",{className:"text-xl font-serif font-light text-white tracking-wider",children:[e.jsx("span",{className:"text-yellow-400 font-bold",children:"FLAWLESS SERVICE:"})," Where Anticipation Meets Execution"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Hi, ",r?.name||"Admin"]}),e.jsx("button",{onClick:d,className:"bg-red-600 text-white px-4 py-2 text-sm font-semibold hover:bg-red-700 transition",children:"Logout"})]})]}),e.jsxs("div",{className:"p-8 flex-1 overflow-y-auto",children:[e.jsx("h1",{className:"text-3xl font-serif font-bold text-zinc-800 mb-6 sr-only",children:N.find(t=>a.pathname.startsWith(t.to))?.label||"Admin Panel"}),e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"p-6",children:"Loading Admin Content..."}),children:e.jsx(z,{})})]})]})]})};export{W as default};
