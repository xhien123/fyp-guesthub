import{r as n,B as f,j as e,R as w}from"./index-DGXRDi1R.js";const p="http://localhost:4000",N="http://localhost:4000",y=()=>{const[r,d]=n.useState([]),[h,i]=n.useState(!0),[o,l]=n.useState(null),[c,g]=n.useState(null),u=async()=>{try{l(null),i(!0);const t=await fetch(`${p}/api/admin/inquiries`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch inquiries");const s=await t.json();d(s.inquiries||[])}catch(t){l(t.message||"Failed to load inquiries")}finally{i(!1)}};n.useEffect(()=>{u();const t=f(N,{transports:["websocket"],withCredentials:!0});return t.on("inquiry:new",s=>{d(a=>[s,...a])}),t.on("inquiry:updated",s=>{d(a=>a.map(m=>m._id===s._id?s:m))}),()=>{t.disconnect()}},[]);const x=async(t,s)=>{try{if(!(await fetch(`${p}/api/admin/inquiries/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({status:s})})).ok)throw new Error("Failed to update status")}catch(a){l(a.message||"Failed to update status")}},b=t=>{g(c===t?null:t)},j=({status:t})=>t==="New"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-red-100 text-red-800",children:"New"}):t==="Viewed"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-yellow-100 text-yellow-800",children:"Viewed"}):e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-800",children:"Resolved"});return h&&r.length===0?e.jsx("div",{className:"p-6 text-center text-stone-500",children:"Loading Inquiries..."}):o?e.jsx("div",{className:"p-6 text-center text-red-600",children:o}):e.jsxs("div",{className:"p-6 bg-white shadow rounded-lg",children:[e.jsx("h1",{className:"text-3xl font-serif font-semibold text-stone-900 mb-6",children:"Contact Inquiries"}),r.length===0?e.jsx("p",{className:"text-stone-500",children:"No new inquiries found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject / Promotion"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(t=>{const s=c===t._id;return e.jsxs(w.Fragment,{children:[e.jsxs("tr",{className:`transition-colors duration-200 ${s?"bg-stone-50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 align-top",children:new Date(t.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 align-top",children:[t.name," ",e.jsx("br",{})," ",e.jsx("span",{className:"text-xs text-gray-500",children:t.email})]}),e.jsxs("td",{className:"px-6 py-4 max-w-sm overflow-hidden text-sm text-gray-900 align-top",children:[e.jsx("p",{className:"font-semibold mb-1",children:t.subject}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:t.message})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap align-top",children:e.jsx(j,{status:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium align-top",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>x(t._id,"Viewed"),className:"text-yellow-700 hover:text-yellow-900 text-xs disabled:opacity-50",disabled:t.status!=="New",children:"Mark Viewed"}),e.jsx("button",{onClick:()=>x(t._id,"Resolved"),className:"text-green-600 hover:text-green-900 text-xs disabled:opacity-50",disabled:t.status==="Resolved",children:"Resolve"}),e.jsx("button",{onClick:()=>b(t._id),className:`text-xs px-3 py-1 border rounded transition-colors ${s?"bg-stone-800 text-white border-stone-800":"text-indigo-600 border-indigo-200 hover:border-indigo-600"}`,children:s?"Close":"Details"})]})})]}),s&&e.jsx("tr",{className:"bg-stone-50 border-b border-gray-200 shadow-inner",children:e.jsx("td",{colSpan:5,className:"p-6",children:e.jsxs("div",{className:"bg-white border border-stone-200 rounded-lg shadow-sm p-6 grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-4 border-r border-stone-100 pr-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest",children:"Guest Details"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-stone-900",children:t.name}),e.jsx("div",{className:"text-sm text-stone-600",children:t.email}),t.phone&&e.jsx("div",{className:"text-sm text-stone-600 mt-1",children:t.phone})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-100",children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest",children:"Inquiry ID"}),e.jsx("div",{className:"mt-1 text-xs font-mono text-stone-500",children:t._id})]})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest mb-2",children:"Full Message"}),e.jsx("div",{className:"bg-[#fffdf5] border border-stone-200 p-4 rounded text-sm text-stone-800 font-serif leading-relaxed whitespace-pre-wrap flex-grow",children:t.message}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("a",{href:`mailto:${t.email}?subject=Re: ${t.subject}`,className:"inline-flex items-center px-4 py-2 bg-stone-800 text-white text-xs font-bold uppercase tracking-widest rounded hover:bg-stone-700 transition",children:"Reply via Email"})})]})]})})})]},t._id)})})]})})]})};export{y as default};
