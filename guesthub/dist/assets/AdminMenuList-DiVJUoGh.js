import{t as E,G as F,d as W,R as o,P as H,Q as G,j as e,L as P,S as K,T as Q}from"./index-CtBX9Jbf.js";import{T as J,P as X}from"./Skeleton-CaAjT3sR.js";const Y=()=>e.jsx("svg",{className:"w-4 h-4 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Z=()=>e.jsx("svg",{className:"w-4 h-4 text-neutral-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),ee=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),te=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),re=()=>{const{toast:d}=E(),q=F(),[n,y]=W(),[M,m]=o.useState([]),[z,D]=o.useState([]),[_,N]=o.useState(!0),[w,k]=o.useState(null),h=n.get("restaurant")||"",i=n.get("category")||"",p=n.get("q")||"",u=n.get("avail")||"",I=n.get("sort")||"name:asc",S=Number(n.get("page")||"1"),g=Number(n.get("pageSize")||"10"),[b,f]=(()=>{const[t,a]=I.split(":");return[["name","category","price","available","restaurant"].includes(t)?t:"name",a==="desc"?"desc":"asc"]})(),r=(t,a)=>{const s=new URLSearchParams(n);a&&a.length?s.set(t,a):s.delete(t),["restaurant","category","q","avail"].includes(t)&&s.set("page","1"),y(s,{replace:!0})},T=t=>{r("sort",`${t}:${b===t&&f==="asc"?"desc":"asc"}`)},$=t=>r("page",String(Math.max(1,t))),O=t=>{const a=new URLSearchParams(n);a.set("pageSize",String(t)),a.set("page","1"),y(a,{replace:!0})},v=o.useCallback(async()=>{try{N(!0),k(null);const[t,a]=await Promise.all([H(),G().catch(()=>[])]),s=Array.isArray(a)?a:a?.categories??[];D(s),m(Array.isArray(t)?t:[])}catch(t){k(t?.response?.data?.error||"Failed to load menu")}finally{N(!1)}},[]);o.useEffect(()=>{v()},[v]);const R=async t=>{if(await q({title:"Delete Dish?",message:"This will permanently remove this item from the menu.",confirmText:"Delete"}))try{await Q(t),d({title:"Dish removed",variant:"success"}),await v()}catch{d({title:"Failed to delete item",variant:"error"})}},U=async t=>{const a=t.available,s=!a;m(x=>x.map(l=>l._id===t._id?{...l,available:s}:l));try{await K(t._id,{available:s}),d({title:s?"Marked Available":"Marked Unavailable",description:t.name,variant:"success"})}catch{m(x=>x.map(l=>l._id===t._id?{...l,available:a}:l)),d({title:"Failed to update status",description:`Could not change availability for ${t.name}. Please try again.`,variant:"error"})}},j=M.filter(t=>{if(h&&t.restaurant!==h||i&&!(t.category===i||t.category?._id===i||t.category?.name===i))return!1;if(p){const a=p.toLowerCase();if(!t.name?.toLowerCase().includes(a)&&!t.description?.toLowerCase().includes(a))return!1}if(u){const a=u==="true";if(!!t.available!==a)return!1}return!0}),C=[...j].sort((t,a)=>{let s=0;switch(b){case"name":s=String(t.name).localeCompare(String(a.name));break;case"restaurant":s=String(t.restaurant).localeCompare(String(a.restaurant));break;case"category":s=String(t.category?.name??t.category??"").localeCompare(String(a.category?.name??a.category??""));break;case"price":s=Number(t.price??0)-Number(a.price??0);break;case"available":s=+!!t.available-+!!a.available;break;default:s=0}return f==="asc"?s:-s}),L=(S-1)*g,A=C.slice(L,L+g),V=j.length,B=j.filter(t=>!t.available||t.quantity!==null&&t.quantity!==void 0&&t.quantity<=0).length,c=({k:t,children:a})=>e.jsxs("button",{onClick:()=>T(t),className:"group inline-flex items-center gap-1 font-semibold text-xs uppercase tracking-wider text-neutral-500 hover:text-black transition-colors",title:"Sort",children:[a,e.jsx("span",{className:`text-[10px] transition-opacity ${b===t?"opacity-100 text-black":"opacity-0 group-hover:opacity-50"}`,children:f==="asc"?"â–²":"â–¼"})]});return _?e.jsx(J,{rows:8,cols:6}):w?e.jsx("div",{className:"p-6 text-center text-red-600 bg-red-50 rounded-xl border border-red-100",children:w}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 border-b border-neutral-100 pb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-medium text-neutral-900 tracking-tight",children:"Culinary Management"}),e.jsx("p",{className:"text-neutral-500 mt-1",children:"Orchestrate the dining experience across all venues."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden md:flex gap-6 text-sm px-4 py-2 bg-white border border-neutral-100 rounded-full shadow-sm text-neutral-600",children:[e.jsxs("span",{children:["Total Items: ",e.jsx("strong",{className:"text-black",children:V})]}),e.jsx("span",{className:"w-px h-4 bg-neutral-200"}),e.jsxs("span",{children:["Sold Out: ",e.jsx("strong",{className:"text-red-600",children:B})]})]}),e.jsx(P,{to:"/admin/menu/new",className:"flex items-center gap-2 rounded-xl px-5 py-2.5 bg-black text-white text-sm font-medium hover:bg-neutral-800 transition-all shadow-lg shadow-neutral-900/10",children:e.jsx("span",{children:"+ Create Dish"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-1.5 bg-neutral-100/50 rounded-2xl border border-neutral-200/60 backdrop-blur-xl",children:[e.jsxs("div",{className:"relative group flex-1 min-w-[200px]",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 transition-colors group-focus-within:text-black",children:e.jsx(Y,{})}),e.jsx("input",{className:"w-full pl-10 pr-4 py-2 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-2 focus:ring-black/5 focus:border-black outline-none transition-all shadow-sm",placeholder:"Search by name or description...",defaultValue:p,onChange:t=>r("q",t.target.value)})]}),e.jsx("div",{className:"h-8 w-px bg-neutral-300/50 mx-1 hidden sm:block"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx(Z,{})}),e.jsxs("select",{className:"pl-9 pr-8 py-2 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-2 focus:ring-black/5 focus:border-black outline-none appearance-none cursor-pointer shadow-sm hover:border-neutral-300 transition-colors min-w-[160px]",value:h,onChange:t=>r("restaurant",t.target.value),children:[e.jsx("option",{value:"",children:"All Restaurants"}),e.jsx("option",{value:"savory-sizzle",children:"Savory Sizzle"}),e.jsx("option",{value:"vive-oceane",children:"Vive Oceane"})]})]}),e.jsxs("select",{className:"px-4 py-2 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-2 focus:ring-black/5 focus:border-black outline-none cursor-pointer shadow-sm hover:border-neutral-300 transition-colors",value:i,onChange:t=>r("category",t.target.value),children:[e.jsx("option",{value:"",children:"All Categories"}),z.map(t=>e.jsx("option",{value:t._id??t.name,children:t.name},t._id??t.name))]}),e.jsxs("select",{className:`px-4 py-2 border rounded-xl text-sm focus:ring-2 focus:ring-black/5 outline-none cursor-pointer shadow-sm transition-colors ${u?"bg-neutral-900 text-white border-neutral-900":"bg-white border-neutral-200 hover:border-neutral-300"}`,value:u,onChange:t=>r("avail",t.target.value),children:[e.jsx("option",{value:"",className:"text-black bg-white",children:"Status: All"}),e.jsx("option",{value:"true",className:"text-black bg-white",children:"Available Only"}),e.jsx("option",{value:"false",className:"text-black bg-white",children:"Unavailable Only"})," "]})]}),e.jsx("div",{className:"rounded-2xl border border-neutral-200 overflow-hidden bg-white shadow-sm",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-neutral-50/50 border-b border-neutral-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-5 w-[40%]",children:e.jsx(c,{k:"name",children:"Dish Profile"})}),e.jsx("th",{className:"p-5",children:e.jsx(c,{k:"restaurant",children:"Venue"})}),e.jsx("th",{className:"p-5",children:e.jsx(c,{k:"category",children:"Category"})}),e.jsx("th",{className:"p-5",children:e.jsx(c,{k:"price",children:"Price"})}),e.jsx("th",{className:"p-5",children:e.jsx(c,{k:"available",children:"Stock Status"})}),e.jsx("th",{className:"p-5 text-right font-semibold text-xs uppercase tracking-wider text-neutral-500",children:"Manage"})]})}),e.jsxs("tbody",{className:"divide-y divide-neutral-100",children:[A.map(t=>e.jsxs("tr",{className:"group hover:bg-neutral-50/50 transition-all duration-200",children:[e.jsx("td",{className:"p-5",children:e.jsxs("div",{className:"flex items-start gap-5",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-neutral-100 overflow-hidden shrink-0 border border-neutral-200 shadow-sm group-hover:shadow-md transition-all",children:t.photo?e.jsx("img",{src:t.photo,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl opacity-30",children:"ðŸ½ï¸"})}),e.jsxs("div",{className:"pt-1",children:[e.jsx("div",{className:"font-display font-semibold text-lg text-neutral-900 group-hover:text-black transition-colors",children:t.name}),t.description&&e.jsx("div",{className:"text-xs text-neutral-500 line-clamp-1 max-w-[280px] mt-1 font-light",children:t.description})]})]})}),e.jsx("td",{className:"p-5 align-middle",children:t.restaurant==="savory-sizzle"?e.jsx("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-orange-50/80 px-3 py-1 text-xs font-bold tracking-wide text-orange-800 border border-orange-100/50 shadow-sm",children:"ðŸ”¥ Savory"}):e.jsx("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-blue-50/80 px-3 py-1 text-xs font-bold tracking-wide text-blue-800 border border-blue-100/50 shadow-sm",children:"ðŸŒŠ Oceane"})}),e.jsx("td",{className:"p-5 align-middle text-neutral-600 font-medium",children:t.category?.name??t.category}),e.jsxs("td",{className:"p-5 align-middle font-mono font-medium text-neutral-900 tracking-tight text-base",children:["$",Number(t.price??0).toFixed(2)]}),e.jsx("td",{className:"p-5 align-middle",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>U(t),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black/20 ${t.available?"bg-emerald-500":"bg-neutral-200"}`,title:t.available?"Click to mark Unavailable":"Click to mark Available",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow transition-transform duration-300 ${t.available?"translate-x-6":"translate-x-1"}`})}),t.available?t.quantity!==null&&t.quantity!==void 0&&t.quantity<=0?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-red-100 text-red-700 border border-red-100",children:"Sold Out"}):t.quantity!==null&&t.quantity!==void 0?e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-orange-50 text-orange-700 border border-orange-100",children:[t.quantity," Left"]}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-green-50 text-green-700 border border-green-100",children:"In Stock"}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-neutral-100 text-neutral-400 border border-neutral-200",children:"Unavailable"})]})}),e.jsx("td",{className:"p-5 align-middle text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-40 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(P,{to:`/admin/menu/${t._id}/edit`,className:"p-2 rounded-lg hover:bg-neutral-200 text-neutral-600 transition-colors",title:"Edit Dish",children:e.jsx(ee,{})}),e.jsx("button",{onClick:()=>R(t._id),className:"p-2 rounded-lg hover:bg-red-50 text-red-500 hover:text-red-600 transition-colors",title:"Delete Dish",children:e.jsx(te,{})})]})})]},t._id)),A.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-16 text-center",colSpan:6,children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center text-2xl mb-4",children:"ðŸ¥—"}),e.jsx("h3",{className:"text-neutral-900 font-medium mb-1",children:"No dishes found"}),e.jsx("p",{className:"text-neutral-500 text-sm mb-6",children:"Try adjusting your search or filters."}),e.jsx("button",{onClick:()=>{r("q",""),r("restaurant",""),r("category",""),r("avail","")},className:"text-sm font-medium text-black underline hover:opacity-70",children:"Clear all filters"})]})})})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(X,{className:"bg-white border border-neutral-200 rounded-xl shadow-sm px-2 py-1",page:S,pageSize:g,total:C.length,onPage:$,onPageSize:O})})]})};export{re as default};
